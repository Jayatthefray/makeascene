{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { createContext, useContext, useState, useEffect } from 'react';\nimport { signUp, signIn, signOut, getCurrentUser } from \"../../lib/supabase/supabase\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nvar AuthContext = createContext();\nexport function AuthProvider(_ref) {\n  var children = _ref.children;\n  var _useState = useState(null),\n    _useState2 = _slicedToArray(_useState, 2),\n    user = _useState2[0],\n    setUser = _useState2[1];\n  var _useState3 = useState(true),\n    _useState4 = _slicedToArray(_useState3, 2),\n    loading = _useState4[0],\n    setLoading = _useState4[1];\n  var _useState5 = useState(null),\n    _useState6 = _slicedToArray(_useState5, 2),\n    error = _useState6[0],\n    setError = _useState6[1];\n  useEffect(function () {\n    function loadUser() {\n      return _loadUser.apply(this, arguments);\n    }\n    function _loadUser() {\n      _loadUser = _asyncToGenerator(function* () {\n        try {\n          var _yield$getCurrentUser = yield getCurrentUser(),\n            _user = _yield$getCurrentUser.user;\n          setUser(_user);\n        } catch (err) {\n          console.warn('Auth initialization failed:', err);\n          setError('Authentication service unavailable');\n        } finally {\n          setLoading(false);\n        }\n      });\n      return _loadUser.apply(this, arguments);\n    }\n    loadUser();\n  }, []);\n  var handleSignUp = function () {\n    var _ref2 = _asyncToGenerator(function* (email, password) {\n      try {\n        var _yield$signUp = yield signUp(email, password),\n          data = _yield$signUp.data,\n          _error = _yield$signUp.error;\n        if (!_error) setUser((data == null ? void 0 : data.user) || null);\n        setError(_error);\n        return {\n          data: data,\n          error: _error\n        };\n      } catch (err) {\n        var errorMsg = 'Authentication service unavailable';\n        setError(errorMsg);\n        return {\n          data: null,\n          error: {\n            message: errorMsg\n          }\n        };\n      }\n    });\n    return function handleSignUp(_x, _x2) {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  var handleSignIn = function () {\n    var _ref3 = _asyncToGenerator(function* (email, password) {\n      try {\n        var _yield$signIn = yield signIn(email, password),\n          data = _yield$signIn.data,\n          _error2 = _yield$signIn.error;\n        if (!_error2) setUser((data == null ? void 0 : data.user) || null);\n        setError(_error2);\n        return {\n          data: data,\n          error: _error2\n        };\n      } catch (err) {\n        var errorMsg = 'Authentication service unavailable';\n        setError(errorMsg);\n        return {\n          data: null,\n          error: {\n            message: errorMsg\n          }\n        };\n      }\n    });\n    return function handleSignIn(_x3, _x4) {\n      return _ref3.apply(this, arguments);\n    };\n  }();\n  var handleSignOut = function () {\n    var _ref4 = _asyncToGenerator(function* () {\n      try {\n        var _yield$signOut = yield signOut(),\n          _error3 = _yield$signOut.error;\n        if (!_error3) setUser(null);\n        setError(_error3);\n        return {\n          error: _error3\n        };\n      } catch (err) {\n        setUser(null);\n        return {\n          error: null\n        };\n      }\n    });\n    return function handleSignOut() {\n      return _ref4.apply(this, arguments);\n    };\n  }();\n  return _jsx(AuthContext.Provider, {\n    value: {\n      user: user,\n      loading: loading,\n      error: error,\n      signUp: handleSignUp,\n      signIn: handleSignIn,\n      signOut: handleSignOut,\n      logout: handleSignOut\n    },\n    children: children\n  });\n}\nexport function useAuth() {\n  return useContext(AuthContext);\n}","map":{"version":3,"names":["React","createContext","useContext","useState","useEffect","signUp","signIn","signOut","getCurrentUser","jsx","_jsx","AuthContext","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","user","setUser","_useState3","_useState4","loading","setLoading","_useState5","_useState6","error","setError","loadUser","_loadUser","apply","arguments","_asyncToGenerator","_yield$getCurrentUser","err","console","warn","handleSignUp","_ref2","email","password","_yield$signUp","data","errorMsg","message","_x","_x2","handleSignIn","_ref3","_yield$signIn","_x3","_x4","handleSignOut","_ref4","_yield$signOut","Provider","value","logout","useAuth"],"sources":["/workspace/MakeAScene/src/contexts/AuthContext.js"],"sourcesContent":["import React, { createContext, useContext, useState, useEffect } from 'react';\nimport { signUp, signIn, signOut, getCurrentUser } from '../../lib/supabase/supabase';\n\nconst AuthContext = createContext();\n\nexport function AuthProvider({ children }) {\n  const [user, setUser] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    async function loadUser() {\n      try {\n        const { user } = await getCurrentUser();\n        setUser(user);\n      } catch (err) {\n        console.warn('Auth initialization failed:', err);\n        setError('Authentication service unavailable');\n      } finally {\n        setLoading(false);\n      }\n    }\n    loadUser();\n  }, []);\n\n  const handleSignUp = async (email, password) => {\n    try {\n      const { data, error } = await signUp(email, password);\n      if (!error) setUser(data?.user || null);\n      setError(error);\n      return { data, error };\n    } catch (err) {\n      const errorMsg = 'Authentication service unavailable';\n      setError(errorMsg);\n      return { data: null, error: { message: errorMsg } };\n    }\n  };\n\n  const handleSignIn = async (email, password) => {\n    try {\n      const { data, error } = await signIn(email, password);\n      if (!error) setUser(data?.user || null);\n      setError(error);\n      return { data, error };\n    } catch (err) {\n      const errorMsg = 'Authentication service unavailable';\n      setError(errorMsg);\n      return { data: null, error: { message: errorMsg } };\n    }\n  };\n\n  const handleSignOut = async () => {\n    try {\n      const { error } = await signOut();\n      if (!error) setUser(null);\n      setError(error);\n      return { error };\n    } catch (err) {\n      // Even if signout fails, clear local user state\n      setUser(null);\n      return { error: null };\n    }\n  };\n\n  return (\n    <AuthContext.Provider value={{ \n      user, \n      loading, \n      error, \n      signUp: handleSignUp, \n      signIn: handleSignIn, \n      signOut: handleSignOut,\n      logout: handleSignOut // Legacy alias\n    }}>\n      {children}\n    </AuthContext.Provider>\n  );\n}\n\nexport function useAuth() {\n  return useContext(AuthContext);\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}